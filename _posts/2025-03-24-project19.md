---
title: "[develop] 제품 검색 로직 변경"
excerpt: "제품 검색 로직 변경"

writer: Audrey
categories: [develop]

toc: true
toc_sticky: true

pin: true

date: 2025-03-24 22:07:00 +09:00
last_modified_at: 2025-03-24 22:07:00 +09:00

tags: [develop]
---


원래 기존 제품 검색 로직은 다음과 같다.

![Image](https://github.com/user-attachments/assets/2838ecdb-dbf7-465f-b909-679215d06fe9)

- 제품 input을 클릭한 뒤 표시되는 모달 창에서 원하는 제품명을 입력하고 돋보기 버튼을 클릭
- 서버에서 검색 결과를 가져와서 아래에 item으로 표시
- 검색 결과가 없을 경우 직접 등록 item만 표시되고 해당 아이템 클릭하면 검색한 검색어를 그대로 제품 선택 input으로 옮겨온다.

<br>

그런데 검색할 때 보면 전체 단어를 다 작성하지 않고 검색하는 경우가 많다.
- 예를 들어, 제품명이 기억이 나지 않을 때 ‘하리보 피코’ 까지만 검색하고 버튼을 누를 수 있다.
- 그런데 결과가 없을 경우 직접 등록 아이템을 클릭하면 ‘하리보 피코’라는 단어 자체를 등록하게 된다.
- 새 제품을 등록할 때 풀네임으로 등록하려면 굳이 이름을 새로 작성해서 돋보기 버튼을 누르고 추가해야 하는 불상사가 발생하고 있다.

<br>

그래서 해당 제품 검색 로직을 좀 변경하기로 했다.

- 일단 돋보기 버튼을 클릭하면 서버에 요청을 보내는 것이 아니라, 제품 검색 input 자체에 keyup 이벤트를 걸어서 사용자가 제품명을 입력함과 동시에 검색 요청을 서버에 보내는 것으로 변경했다.
- 이때 keyup 이벤트 같은 경우에는 키보드를 누르면 실행되기 때문에 이벤트가 실행될때마다 요청을 보내게 되면 서버에 엄청난 과부하가 올 것이다.
    - debounce라는 기술을 사용해서 이벤트가 여러번 실행되면 가장 마지막 이벤트만 실행되도록 구현하기로 했다.

<br>

```jsx
const fnDebounce = (fn, delay)  => {
    let timer;
    return function(...args) {
        clearTimeout(timer);
        timer = setTimeout(() => {
            fn.apply(this, args);
        }, delay);
    };
}

$('#product-name').on('keyup', fnDebounce(fnSearchProduct, 400));
```

- 위와 같은 방식으로 0.4초마다 이벤트가 실행되도록 호출을 제한했다.
    - clearTimeout(timer)는 이전에 등록된 타이머가 있으면 취소해준다.
    - 계속 입력 중일 경우 이전 실행 예약은 취소되야 하기 때문..!
    - 사용자가 입력을 멈추면 delay만큼 기다렸다가 인자로 받은 함수 fn을 실행한다.
- 실제로 키를 누를때마다 실행되어 한 단어를 작성하면 10번씩 실행되던 이벤트가 debounce를 적용하고 나니 2~3번으로 감소하였다.

<br>

![Image](https://github.com/user-attachments/assets/1f829040-6bfc-4fba-866d-0fd9c91880d0)

- 위와 같이 검색 결과가 없을 경우 추가되는 제품명을 직접 보여주는 코드도 추가했다.